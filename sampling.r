{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "e9266554",
   "metadata": {
    "papermill": {
     "duration": 0.034949,
     "end_time": "2022-03-17T12:39:05.278517",
     "exception": false,
     "start_time": "2022-03-17T12:39:05.243568",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Label a sample of pictures\n",
    "\n",
    "We would like to label pictures with bounding box. Unfortunately, with 51033 pictures, we avoid to label all of them. Instead, we would like to label a sample of them. This sample should represent the shape variability of our population. We will then stratify the sampling by specy.\n",
    "\n",
    "## Corrected dataset\n",
    "\n",
    "Let us load the corrected metadata."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3f624c60",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-17T12:39:05.351746Z",
     "iopub.status.busy": "2022-03-17T12:39:05.348406Z",
     "iopub.status.idle": "2022-03-17T12:39:05.656037Z",
     "shell.execute_reply": "2022-03-17T12:39:05.655211Z"
    },
    "papermill": {
     "duration": 0.34459,
     "end_time": "2022-03-17T12:39:05.656197",
     "exception": false,
     "start_time": "2022-03-17T12:39:05.311607",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n",
      "Attaching package: ‘dplyr’\n",
      "\n",
      "\n",
      "The following objects are masked from ‘package:stats’:\n",
      "\n",
      "    filter, lag\n",
      "\n",
      "\n",
      "The following objects are masked from ‘package:base’:\n",
      "\n",
      "    intersect, setdiff, setequal, union\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "library(dplyr)\n",
    "library(readr)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "00aac79f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-17T12:39:05.773188Z",
     "iopub.status.busy": "2022-03-17T12:39:05.740001Z",
     "iopub.status.idle": "2022-03-17T12:39:06.312877Z",
     "shell.execute_reply": "2022-03-17T12:39:06.313667Z"
    },
    "papermill": {
     "duration": 0.61764,
     "end_time": "2022-03-17T12:39:06.313863",
     "exception": false,
     "start_time": "2022-03-17T12:39:05.696223",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A tibble: 51033 × 5</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>family</th><th scope=col>genus</th><th scope=col>specy</th><th scope=col>individual</th><th scope=col>picture</th></tr>\n",
       "\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>Delphinidae    </td><td>Peponocephala </td><td>P. electra      </td><td>cadddb1636b9</td><td>00021adfb725ed.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera     </td><td>M. novaeangliae </td><td>1a71fbb72250</td><td>000562241d384d.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Pseudorca     </td><td>P. crassidens   </td><td>60008f293a2b</td><td>0007c33415ce37.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus    </td><td>4b00fe572063</td><td>0007d9bca26a99.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera     </td><td>M. novaeangliae </td><td>8e5253662392</td><td>00087baf5cef7a.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus    </td><td>b9907151f66e</td><td>000a8f2d5c316a.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas       </td><td>afb9b3978217</td><td>000be9acf46619.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera     </td><td>M. novaeangliae </td><td>444d8894ccc8</td><td>000bef247c7a42.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas       </td><td>df94b15285b9</td><td>000c3d63069748.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus    </td><td>b11b2404c7e3</td><td>000c476c11bad5.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. acutorostrata</td><td>19fbb960f07d</td><td>001001f099519f.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. physalus     </td><td>180c0ab04dcd</td><td>00103cbe9d25ce.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus    </td><td>b9907151f66e</td><td>00144776eb476d.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas       </td><td>0ad50d0d9b06</td><td>00167e8375c967.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus    </td><td>812be36c2aef</td><td>00177f3c614d1e.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus    </td><td>445270d9ad52</td><td>0017b3749cd769.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. musculus     </td><td>4790ec346170</td><td>0018064338b499.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera     </td><td>M. novaeangliae </td><td>bc14b5054353</td><td>001b0900f56e89.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. musculus     </td><td>ff69d0975a73</td><td>001cfade605960.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. acutorostrata</td><td>780fefdb6198</td><td>001f1a1f22da96.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Eschrichtius  </td><td>E. robustus     </td><td>a8c9dfb8ac6f</td><td>0020004d64ae20.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. musculus     </td><td>6c4372e42db1</td><td>00206a224e68de.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera     </td><td>M. novaeangliae </td><td>35f898e6595e</td><td>0022bdb8eb5684.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Pseudorca     </td><td>P. crassidens   </td><td>bfb74132d1db</td><td>00234b893ea9e8.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. acutorostrata</td><td>114207cab555</td><td>0024057bbc89a4.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas       </td><td>3cbfd98eea8f</td><td>00243d4b15bafc.jpg</td></tr>\n",
       "\t<tr><td>Balaenidae     </td><td>Eubalaena     </td><td>E. australis    </td><td>f5eab86405b4</td><td>002618d6f63ebc.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus    </td><td>956562ff2888</td><td>0028f6fa123686.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Peponocephala </td><td>P. electra      </td><td>c27f0a7f4e5a</td><td>0029d877c29ab4.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Pseudorca     </td><td>P. crassidens   </td><td>f7bb4f9a9d1a</td><td>002ac5f9ad7c10.jpg</td></tr>\n",
       "\t<tr><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Lagenorhynchus</td><td>L. obscurus    </td><td>4de77853688d</td><td>ffd233d91c41c7.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. musculus    </td><td>9a7cde6b8289</td><td>ffd90e2198cec7.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Peponocephala </td><td>P. electra     </td><td>3509cb6a8504</td><td>ffda27396b72d3.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas      </td><td>4134fe49e6ca</td><td>ffdb5381c9e5cc.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus   </td><td>3d8ae153f3d7</td><td>ffde8e59c047d3.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera     </td><td>M. novaeangliae</td><td>7a7f988bc077</td><td>ffdf30eb77e702.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera     </td><td>M. novaeangliae</td><td>f263fb6c725a</td><td>ffe12f8cae2441.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus   </td><td>a59972315f7d</td><td>ffe1a56bdd912c.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus   </td><td>956562ff2888</td><td>ffe24f955ff264.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Globicephala  </td><td>G. melas       </td><td>e880e47c06a4</td><td>ffe2cfd8177062.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. musculus    </td><td>df85d8ec8bfc</td><td>ffe341ae54dcf4.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas      </td><td>97589576e678</td><td>ffe6648966bb29.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera     </td><td>M. novaeangliae</td><td>b58b560b67c3</td><td>ffe66ecf7cb138.jpg</td></tr>\n",
       "\t<tr><td>Balaenidae     </td><td>Eubalaena     </td><td>E. australis   </td><td>a8a663f9f7f0</td><td>ffe6940bd23980.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Pseudorca     </td><td>P. crassidens  </td><td>b602f1224dee</td><td>ffe697db80edfa.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Lagenorhynchus</td><td>L. obscurus    </td><td>bc6fcab946c4</td><td>ffeae1cc606ed6.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus   </td><td>424d49bef76e</td><td>ffecd4a6afc94a.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas      </td><td>1e1e577830be</td><td>ffedfd04fd357b.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Stenella      </td><td>S. longirostris</td><td>afe8b7c1b1c6</td><td>ffeed309a3081e.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Globicephala  </td><td>G. melas       </td><td>ada9e2afe2bd</td><td>fff219829b3c68.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas      </td><td>3b9152077a31</td><td>fff2dbac692435.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Pseudorca     </td><td>P. crassidens  </td><td>be2aa86d0e5b</td><td>fff4686bea76f0.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera     </td><td>M. novaeangliae</td><td>ff95891f0378</td><td>fff47736026701.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Pseudorca     </td><td>P. crassidens  </td><td>b90d49ab0905</td><td>fff54859cb0beb.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. physalus    </td><td>40fe65946167</td><td>fff603f5af8614.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas      </td><td>5ac053677ed1</td><td>fff639a7a78b3f.jpg</td></tr>\n",
       "\t<tr><td>Ziphiidae      </td><td>Ziphius       </td><td>Z. cavirostris </td><td>1184686361b3</td><td>fff8b32daff17e.jpg</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera  </td><td>B. musculus    </td><td>5401612696b9</td><td>fff94675cc1aef.jpg</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus</td><td>D. leucas      </td><td>4000b3d7c24e</td><td>fffbc5dd642d8c.jpg</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops      </td><td>T. truncatus   </td><td>4ddb2eeb5efb</td><td>fffdcd42312777.jpg</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A tibble: 51033 × 5\n",
       "\\begin{tabular}{lllll}\n",
       " family & genus & specy & individual & picture\\\\\n",
       " <chr> & <chr> & <chr> & <chr> & <chr>\\\\\n",
       "\\hline\n",
       "\t Delphinidae     & Peponocephala  & P. electra       & cadddb1636b9 & 00021adfb725ed.jpg\\\\\n",
       "\t Balaenopteridae & Megaptera      & M. novaeangliae  & 1a71fbb72250 & 000562241d384d.jpg\\\\\n",
       "\t Delphinidae     & Pseudorca      & P. crassidens    & 60008f293a2b & 0007c33415ce37.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus     & 4b00fe572063 & 0007d9bca26a99.jpg\\\\\n",
       "\t Balaenopteridae & Megaptera      & M. novaeangliae  & 8e5253662392 & 00087baf5cef7a.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus     & b9907151f66e & 000a8f2d5c316a.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas        & afb9b3978217 & 000be9acf46619.jpg\\\\\n",
       "\t Balaenopteridae & Megaptera      & M. novaeangliae  & 444d8894ccc8 & 000bef247c7a42.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas        & df94b15285b9 & 000c3d63069748.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus     & b11b2404c7e3 & 000c476c11bad5.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. acutorostrata & 19fbb960f07d & 001001f099519f.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. physalus      & 180c0ab04dcd & 00103cbe9d25ce.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus     & b9907151f66e & 00144776eb476d.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas        & 0ad50d0d9b06 & 00167e8375c967.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus     & 812be36c2aef & 00177f3c614d1e.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus     & 445270d9ad52 & 0017b3749cd769.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. musculus      & 4790ec346170 & 0018064338b499.jpg\\\\\n",
       "\t Balaenopteridae & Megaptera      & M. novaeangliae  & bc14b5054353 & 001b0900f56e89.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. musculus      & ff69d0975a73 & 001cfade605960.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. acutorostrata & 780fefdb6198 & 001f1a1f22da96.jpg\\\\\n",
       "\t Balaenopteridae & Eschrichtius   & E. robustus      & a8c9dfb8ac6f & 0020004d64ae20.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. musculus      & 6c4372e42db1 & 00206a224e68de.jpg\\\\\n",
       "\t Balaenopteridae & Megaptera      & M. novaeangliae  & 35f898e6595e & 0022bdb8eb5684.jpg\\\\\n",
       "\t Delphinidae     & Pseudorca      & P. crassidens    & bfb74132d1db & 00234b893ea9e8.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. acutorostrata & 114207cab555 & 0024057bbc89a4.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas        & 3cbfd98eea8f & 00243d4b15bafc.jpg\\\\\n",
       "\t Balaenidae      & Eubalaena      & E. australis     & f5eab86405b4 & 002618d6f63ebc.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus     & 956562ff2888 & 0028f6fa123686.jpg\\\\\n",
       "\t Delphinidae     & Peponocephala  & P. electra       & c27f0a7f4e5a & 0029d877c29ab4.jpg\\\\\n",
       "\t Delphinidae     & Pseudorca      & P. crassidens    & f7bb4f9a9d1a & 002ac5f9ad7c10.jpg\\\\\n",
       "\t ⋮ & ⋮ & ⋮ & ⋮ & ⋮\\\\\n",
       "\t Delphinidae     & Lagenorhynchus & L. obscurus     & 4de77853688d & ffd233d91c41c7.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. musculus     & 9a7cde6b8289 & ffd90e2198cec7.jpg\\\\\n",
       "\t Delphinidae     & Peponocephala  & P. electra      & 3509cb6a8504 & ffda27396b72d3.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas       & 4134fe49e6ca & ffdb5381c9e5cc.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus    & 3d8ae153f3d7 & ffde8e59c047d3.jpg\\\\\n",
       "\t Balaenopteridae & Megaptera      & M. novaeangliae & 7a7f988bc077 & ffdf30eb77e702.jpg\\\\\n",
       "\t Balaenopteridae & Megaptera      & M. novaeangliae & f263fb6c725a & ffe12f8cae2441.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus    & a59972315f7d & ffe1a56bdd912c.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus    & 956562ff2888 & ffe24f955ff264.jpg\\\\\n",
       "\t Delphinidae     & Globicephala   & G. melas        & e880e47c06a4 & ffe2cfd8177062.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. musculus     & df85d8ec8bfc & ffe341ae54dcf4.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas       & 97589576e678 & ffe6648966bb29.jpg\\\\\n",
       "\t Balaenopteridae & Megaptera      & M. novaeangliae & b58b560b67c3 & ffe66ecf7cb138.jpg\\\\\n",
       "\t Balaenidae      & Eubalaena      & E. australis    & a8a663f9f7f0 & ffe6940bd23980.jpg\\\\\n",
       "\t Delphinidae     & Pseudorca      & P. crassidens   & b602f1224dee & ffe697db80edfa.jpg\\\\\n",
       "\t Delphinidae     & Lagenorhynchus & L. obscurus     & bc6fcab946c4 & ffeae1cc606ed6.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus    & 424d49bef76e & ffecd4a6afc94a.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas       & 1e1e577830be & ffedfd04fd357b.jpg\\\\\n",
       "\t Delphinidae     & Stenella       & S. longirostris & afe8b7c1b1c6 & ffeed309a3081e.jpg\\\\\n",
       "\t Delphinidae     & Globicephala   & G. melas        & ada9e2afe2bd & fff219829b3c68.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas       & 3b9152077a31 & fff2dbac692435.jpg\\\\\n",
       "\t Delphinidae     & Pseudorca      & P. crassidens   & be2aa86d0e5b & fff4686bea76f0.jpg\\\\\n",
       "\t Balaenopteridae & Megaptera      & M. novaeangliae & ff95891f0378 & fff47736026701.jpg\\\\\n",
       "\t Delphinidae     & Pseudorca      & P. crassidens   & b90d49ab0905 & fff54859cb0beb.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. physalus     & 40fe65946167 & fff603f5af8614.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas       & 5ac053677ed1 & fff639a7a78b3f.jpg\\\\\n",
       "\t Ziphiidae       & Ziphius        & Z. cavirostris  & 1184686361b3 & fff8b32daff17e.jpg\\\\\n",
       "\t Balaenopteridae & Balaenoptera   & B. musculus     & 5401612696b9 & fff94675cc1aef.jpg\\\\\n",
       "\t Monodontidae    & Delphinapterus & D. leucas       & 4000b3d7c24e & fffbc5dd642d8c.jpg\\\\\n",
       "\t Delphinidae     & tursiops       & T. truncatus    & 4ddb2eeb5efb & fffdcd42312777.jpg\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A tibble: 51033 × 5\n",
       "\n",
       "| family &lt;chr&gt; | genus &lt;chr&gt; | specy &lt;chr&gt; | individual &lt;chr&gt; | picture &lt;chr&gt; |\n",
       "|---|---|---|---|---|\n",
       "| Delphinidae     | Peponocephala  | P. electra       | cadddb1636b9 | 00021adfb725ed.jpg |\n",
       "| Balaenopteridae | Megaptera      | M. novaeangliae  | 1a71fbb72250 | 000562241d384d.jpg |\n",
       "| Delphinidae     | Pseudorca      | P. crassidens    | 60008f293a2b | 0007c33415ce37.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus     | 4b00fe572063 | 0007d9bca26a99.jpg |\n",
       "| Balaenopteridae | Megaptera      | M. novaeangliae  | 8e5253662392 | 00087baf5cef7a.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus     | b9907151f66e | 000a8f2d5c316a.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas        | afb9b3978217 | 000be9acf46619.jpg |\n",
       "| Balaenopteridae | Megaptera      | M. novaeangliae  | 444d8894ccc8 | 000bef247c7a42.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas        | df94b15285b9 | 000c3d63069748.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus     | b11b2404c7e3 | 000c476c11bad5.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. acutorostrata | 19fbb960f07d | 001001f099519f.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. physalus      | 180c0ab04dcd | 00103cbe9d25ce.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus     | b9907151f66e | 00144776eb476d.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas        | 0ad50d0d9b06 | 00167e8375c967.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus     | 812be36c2aef | 00177f3c614d1e.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus     | 445270d9ad52 | 0017b3749cd769.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. musculus      | 4790ec346170 | 0018064338b499.jpg |\n",
       "| Balaenopteridae | Megaptera      | M. novaeangliae  | bc14b5054353 | 001b0900f56e89.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. musculus      | ff69d0975a73 | 001cfade605960.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. acutorostrata | 780fefdb6198 | 001f1a1f22da96.jpg |\n",
       "| Balaenopteridae | Eschrichtius   | E. robustus      | a8c9dfb8ac6f | 0020004d64ae20.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. musculus      | 6c4372e42db1 | 00206a224e68de.jpg |\n",
       "| Balaenopteridae | Megaptera      | M. novaeangliae  | 35f898e6595e | 0022bdb8eb5684.jpg |\n",
       "| Delphinidae     | Pseudorca      | P. crassidens    | bfb74132d1db | 00234b893ea9e8.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. acutorostrata | 114207cab555 | 0024057bbc89a4.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas        | 3cbfd98eea8f | 00243d4b15bafc.jpg |\n",
       "| Balaenidae      | Eubalaena      | E. australis     | f5eab86405b4 | 002618d6f63ebc.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus     | 956562ff2888 | 0028f6fa123686.jpg |\n",
       "| Delphinidae     | Peponocephala  | P. electra       | c27f0a7f4e5a | 0029d877c29ab4.jpg |\n",
       "| Delphinidae     | Pseudorca      | P. crassidens    | f7bb4f9a9d1a | 002ac5f9ad7c10.jpg |\n",
       "| ⋮ | ⋮ | ⋮ | ⋮ | ⋮ |\n",
       "| Delphinidae     | Lagenorhynchus | L. obscurus     | 4de77853688d | ffd233d91c41c7.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. musculus     | 9a7cde6b8289 | ffd90e2198cec7.jpg |\n",
       "| Delphinidae     | Peponocephala  | P. electra      | 3509cb6a8504 | ffda27396b72d3.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas       | 4134fe49e6ca | ffdb5381c9e5cc.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus    | 3d8ae153f3d7 | ffde8e59c047d3.jpg |\n",
       "| Balaenopteridae | Megaptera      | M. novaeangliae | 7a7f988bc077 | ffdf30eb77e702.jpg |\n",
       "| Balaenopteridae | Megaptera      | M. novaeangliae | f263fb6c725a | ffe12f8cae2441.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus    | a59972315f7d | ffe1a56bdd912c.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus    | 956562ff2888 | ffe24f955ff264.jpg |\n",
       "| Delphinidae     | Globicephala   | G. melas        | e880e47c06a4 | ffe2cfd8177062.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. musculus     | df85d8ec8bfc | ffe341ae54dcf4.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas       | 97589576e678 | ffe6648966bb29.jpg |\n",
       "| Balaenopteridae | Megaptera      | M. novaeangliae | b58b560b67c3 | ffe66ecf7cb138.jpg |\n",
       "| Balaenidae      | Eubalaena      | E. australis    | a8a663f9f7f0 | ffe6940bd23980.jpg |\n",
       "| Delphinidae     | Pseudorca      | P. crassidens   | b602f1224dee | ffe697db80edfa.jpg |\n",
       "| Delphinidae     | Lagenorhynchus | L. obscurus     | bc6fcab946c4 | ffeae1cc606ed6.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus    | 424d49bef76e | ffecd4a6afc94a.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas       | 1e1e577830be | ffedfd04fd357b.jpg |\n",
       "| Delphinidae     | Stenella       | S. longirostris | afe8b7c1b1c6 | ffeed309a3081e.jpg |\n",
       "| Delphinidae     | Globicephala   | G. melas        | ada9e2afe2bd | fff219829b3c68.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas       | 3b9152077a31 | fff2dbac692435.jpg |\n",
       "| Delphinidae     | Pseudorca      | P. crassidens   | be2aa86d0e5b | fff4686bea76f0.jpg |\n",
       "| Balaenopteridae | Megaptera      | M. novaeangliae | ff95891f0378 | fff47736026701.jpg |\n",
       "| Delphinidae     | Pseudorca      | P. crassidens   | b90d49ab0905 | fff54859cb0beb.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. physalus     | 40fe65946167 | fff603f5af8614.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas       | 5ac053677ed1 | fff639a7a78b3f.jpg |\n",
       "| Ziphiidae       | Ziphius        | Z. cavirostris  | 1184686361b3 | fff8b32daff17e.jpg |\n",
       "| Balaenopteridae | Balaenoptera   | B. musculus     | 5401612696b9 | fff94675cc1aef.jpg |\n",
       "| Monodontidae    | Delphinapterus | D. leucas       | 4000b3d7c24e | fffbc5dd642d8c.jpg |\n",
       "| Delphinidae     | tursiops       | T. truncatus    | 4ddb2eeb5efb | fffdcd42312777.jpg |\n",
       "\n"
      ],
      "text/plain": [
       "      family          genus          specy            individual  \n",
       "1     Delphinidae     Peponocephala  P. electra       cadddb1636b9\n",
       "2     Balaenopteridae Megaptera      M. novaeangliae  1a71fbb72250\n",
       "3     Delphinidae     Pseudorca      P. crassidens    60008f293a2b\n",
       "4     Delphinidae     tursiops       T. truncatus     4b00fe572063\n",
       "5     Balaenopteridae Megaptera      M. novaeangliae  8e5253662392\n",
       "6     Delphinidae     tursiops       T. truncatus     b9907151f66e\n",
       "7     Monodontidae    Delphinapterus D. leucas        afb9b3978217\n",
       "8     Balaenopteridae Megaptera      M. novaeangliae  444d8894ccc8\n",
       "9     Monodontidae    Delphinapterus D. leucas        df94b15285b9\n",
       "10    Delphinidae     tursiops       T. truncatus     b11b2404c7e3\n",
       "11    Balaenopteridae Balaenoptera   B. acutorostrata 19fbb960f07d\n",
       "12    Balaenopteridae Balaenoptera   B. physalus      180c0ab04dcd\n",
       "13    Delphinidae     tursiops       T. truncatus     b9907151f66e\n",
       "14    Monodontidae    Delphinapterus D. leucas        0ad50d0d9b06\n",
       "15    Delphinidae     tursiops       T. truncatus     812be36c2aef\n",
       "16    Delphinidae     tursiops       T. truncatus     445270d9ad52\n",
       "17    Balaenopteridae Balaenoptera   B. musculus      4790ec346170\n",
       "18    Balaenopteridae Megaptera      M. novaeangliae  bc14b5054353\n",
       "19    Balaenopteridae Balaenoptera   B. musculus      ff69d0975a73\n",
       "20    Balaenopteridae Balaenoptera   B. acutorostrata 780fefdb6198\n",
       "21    Balaenopteridae Eschrichtius   E. robustus      a8c9dfb8ac6f\n",
       "22    Balaenopteridae Balaenoptera   B. musculus      6c4372e42db1\n",
       "23    Balaenopteridae Megaptera      M. novaeangliae  35f898e6595e\n",
       "24    Delphinidae     Pseudorca      P. crassidens    bfb74132d1db\n",
       "25    Balaenopteridae Balaenoptera   B. acutorostrata 114207cab555\n",
       "26    Monodontidae    Delphinapterus D. leucas        3cbfd98eea8f\n",
       "27    Balaenidae      Eubalaena      E. australis     f5eab86405b4\n",
       "28    Delphinidae     tursiops       T. truncatus     956562ff2888\n",
       "29    Delphinidae     Peponocephala  P. electra       c27f0a7f4e5a\n",
       "30    Delphinidae     Pseudorca      P. crassidens    f7bb4f9a9d1a\n",
       "⋮     ⋮               ⋮              ⋮                ⋮           \n",
       "51004 Delphinidae     Lagenorhynchus L. obscurus      4de77853688d\n",
       "51005 Balaenopteridae Balaenoptera   B. musculus      9a7cde6b8289\n",
       "51006 Delphinidae     Peponocephala  P. electra       3509cb6a8504\n",
       "51007 Monodontidae    Delphinapterus D. leucas        4134fe49e6ca\n",
       "51008 Delphinidae     tursiops       T. truncatus     3d8ae153f3d7\n",
       "51009 Balaenopteridae Megaptera      M. novaeangliae  7a7f988bc077\n",
       "51010 Balaenopteridae Megaptera      M. novaeangliae  f263fb6c725a\n",
       "51011 Delphinidae     tursiops       T. truncatus     a59972315f7d\n",
       "51012 Delphinidae     tursiops       T. truncatus     956562ff2888\n",
       "51013 Delphinidae     Globicephala   G. melas         e880e47c06a4\n",
       "51014 Balaenopteridae Balaenoptera   B. musculus      df85d8ec8bfc\n",
       "51015 Monodontidae    Delphinapterus D. leucas        97589576e678\n",
       "51016 Balaenopteridae Megaptera      M. novaeangliae  b58b560b67c3\n",
       "51017 Balaenidae      Eubalaena      E. australis     a8a663f9f7f0\n",
       "51018 Delphinidae     Pseudorca      P. crassidens    b602f1224dee\n",
       "51019 Delphinidae     Lagenorhynchus L. obscurus      bc6fcab946c4\n",
       "51020 Delphinidae     tursiops       T. truncatus     424d49bef76e\n",
       "51021 Monodontidae    Delphinapterus D. leucas        1e1e577830be\n",
       "51022 Delphinidae     Stenella       S. longirostris  afe8b7c1b1c6\n",
       "51023 Delphinidae     Globicephala   G. melas         ada9e2afe2bd\n",
       "51024 Monodontidae    Delphinapterus D. leucas        3b9152077a31\n",
       "51025 Delphinidae     Pseudorca      P. crassidens    be2aa86d0e5b\n",
       "51026 Balaenopteridae Megaptera      M. novaeangliae  ff95891f0378\n",
       "51027 Delphinidae     Pseudorca      P. crassidens    b90d49ab0905\n",
       "51028 Balaenopteridae Balaenoptera   B. physalus      40fe65946167\n",
       "51029 Monodontidae    Delphinapterus D. leucas        5ac053677ed1\n",
       "51030 Ziphiidae       Ziphius        Z. cavirostris   1184686361b3\n",
       "51031 Balaenopteridae Balaenoptera   B. musculus      5401612696b9\n",
       "51032 Monodontidae    Delphinapterus D. leucas        4000b3d7c24e\n",
       "51033 Delphinidae     tursiops       T. truncatus     4ddb2eeb5efb\n",
       "      picture           \n",
       "1     00021adfb725ed.jpg\n",
       "2     000562241d384d.jpg\n",
       "3     0007c33415ce37.jpg\n",
       "4     0007d9bca26a99.jpg\n",
       "5     00087baf5cef7a.jpg\n",
       "6     000a8f2d5c316a.jpg\n",
       "7     000be9acf46619.jpg\n",
       "8     000bef247c7a42.jpg\n",
       "9     000c3d63069748.jpg\n",
       "10    000c476c11bad5.jpg\n",
       "11    001001f099519f.jpg\n",
       "12    00103cbe9d25ce.jpg\n",
       "13    00144776eb476d.jpg\n",
       "14    00167e8375c967.jpg\n",
       "15    00177f3c614d1e.jpg\n",
       "16    0017b3749cd769.jpg\n",
       "17    0018064338b499.jpg\n",
       "18    001b0900f56e89.jpg\n",
       "19    001cfade605960.jpg\n",
       "20    001f1a1f22da96.jpg\n",
       "21    0020004d64ae20.jpg\n",
       "22    00206a224e68de.jpg\n",
       "23    0022bdb8eb5684.jpg\n",
       "24    00234b893ea9e8.jpg\n",
       "25    0024057bbc89a4.jpg\n",
       "26    00243d4b15bafc.jpg\n",
       "27    002618d6f63ebc.jpg\n",
       "28    0028f6fa123686.jpg\n",
       "29    0029d877c29ab4.jpg\n",
       "30    002ac5f9ad7c10.jpg\n",
       "⋮     ⋮                 \n",
       "51004 ffd233d91c41c7.jpg\n",
       "51005 ffd90e2198cec7.jpg\n",
       "51006 ffda27396b72d3.jpg\n",
       "51007 ffdb5381c9e5cc.jpg\n",
       "51008 ffde8e59c047d3.jpg\n",
       "51009 ffdf30eb77e702.jpg\n",
       "51010 ffe12f8cae2441.jpg\n",
       "51011 ffe1a56bdd912c.jpg\n",
       "51012 ffe24f955ff264.jpg\n",
       "51013 ffe2cfd8177062.jpg\n",
       "51014 ffe341ae54dcf4.jpg\n",
       "51015 ffe6648966bb29.jpg\n",
       "51016 ffe66ecf7cb138.jpg\n",
       "51017 ffe6940bd23980.jpg\n",
       "51018 ffe697db80edfa.jpg\n",
       "51019 ffeae1cc606ed6.jpg\n",
       "51020 ffecd4a6afc94a.jpg\n",
       "51021 ffedfd04fd357b.jpg\n",
       "51022 ffeed309a3081e.jpg\n",
       "51023 fff219829b3c68.jpg\n",
       "51024 fff2dbac692435.jpg\n",
       "51025 fff4686bea76f0.jpg\n",
       "51026 fff47736026701.jpg\n",
       "51027 fff54859cb0beb.jpg\n",
       "51028 fff603f5af8614.jpg\n",
       "51029 fff639a7a78b3f.jpg\n",
       "51030 fff8b32daff17e.jpg\n",
       "51031 fff94675cc1aef.jpg\n",
       "51032 fffbc5dd642d8c.jpg\n",
       "51033 fffdcd42312777.jpg"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "data <- \"/kaggle/input/happywhaleindividualtaxonomy/final.csv\" %>%\n",
    "    read_csv(col_types = 'c') %>%\n",
    "    rename(individual = individual_id, picture = image) %>%\n",
    "    select(family, genus, specy, individual, picture) %>%\n",
    "    as_tibble()\n",
    "data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "104a0000",
   "metadata": {
    "papermill": {
     "duration": 0.044703,
     "end_time": "2022-03-17T12:39:06.403547",
     "exception": false,
     "start_time": "2022-03-17T12:39:06.358844",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Specy representation in the dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "f2f98006",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-17T12:39:06.492850Z",
     "iopub.status.busy": "2022-03-17T12:39:06.492126Z",
     "iopub.status.idle": "2022-03-17T12:39:06.585523Z",
     "shell.execute_reply": "2022-03-17T12:39:06.584842Z"
    },
    "papermill": {
     "duration": 0.139905,
     "end_time": "2022-03-17T12:39:06.585662",
     "exception": false,
     "start_time": "2022-03-17T12:39:06.445757",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A tibble: 26 × 3</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>specy</th><th scope=col>individuals</th><th scope=col>pictures</th></tr>\n",
       "\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>B. acutorostrata</td><td> 128</td><td> 1608</td></tr>\n",
       "\t<tr><td>B. borealis     </td><td> 197</td><td>  428</td></tr>\n",
       "\t<tr><td>B. brydei       </td><td>  44</td><td>  154</td></tr>\n",
       "\t<tr><td>B. musculus     </td><td>2348</td><td> 4830</td></tr>\n",
       "\t<tr><td>B. physalus     </td><td> 466</td><td> 1324</td></tr>\n",
       "\t<tr><td>C. commersonii  </td><td>  70</td><td>   90</td></tr>\n",
       "\t<tr><td>D. delphis      </td><td>  38</td><td>  347</td></tr>\n",
       "\t<tr><td>D. leucas       </td><td>1012</td><td> 7443</td></tr>\n",
       "\t<tr><td>E. australis    </td><td> 549</td><td>  866</td></tr>\n",
       "\t<tr><td>E. robustus     </td><td> 185</td><td> 1123</td></tr>\n",
       "\t<tr><td>F. attenuata    </td><td>  24</td><td>   76</td></tr>\n",
       "\t<tr><td>G. macrorhynchus</td><td> 214</td><td>  367</td></tr>\n",
       "\t<tr><td>G. melas        </td><td> 375</td><td>  616</td></tr>\n",
       "\t<tr><td>L. acutus       </td><td> 175</td><td>  229</td></tr>\n",
       "\t<tr><td>L. hosei        </td><td>  13</td><td>   14</td></tr>\n",
       "\t<tr><td>L. obscurus     </td><td>2731</td><td> 3139</td></tr>\n",
       "\t<tr><td>M. novaeangliae </td><td>2679</td><td> 7392</td></tr>\n",
       "\t<tr><td>O. orca         </td><td> 472</td><td> 2455</td></tr>\n",
       "\t<tr><td>P. crassidens   </td><td> 196</td><td> 3326</td></tr>\n",
       "\t<tr><td>P. electra      </td><td>1323</td><td> 1689</td></tr>\n",
       "\t<tr><td>S. attenuata    </td><td>  44</td><td>  145</td></tr>\n",
       "\t<tr><td>S. bredanensis  </td><td>  46</td><td>   60</td></tr>\n",
       "\t<tr><td>S. frontalis    </td><td> 280</td><td>  490</td></tr>\n",
       "\t<tr><td>S. longirostris </td><td> 891</td><td> 1700</td></tr>\n",
       "\t<tr><td>T. truncatus    </td><td> 904</td><td>10781</td></tr>\n",
       "\t<tr><td>Z. cavirostris  </td><td> 183</td><td>  341</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A tibble: 26 × 3\n",
       "\\begin{tabular}{lll}\n",
       " specy & individuals & pictures\\\\\n",
       " <chr> & <int> & <int>\\\\\n",
       "\\hline\n",
       "\t B. acutorostrata &  128 &  1608\\\\\n",
       "\t B. borealis      &  197 &   428\\\\\n",
       "\t B. brydei        &   44 &   154\\\\\n",
       "\t B. musculus      & 2348 &  4830\\\\\n",
       "\t B. physalus      &  466 &  1324\\\\\n",
       "\t C. commersonii   &   70 &    90\\\\\n",
       "\t D. delphis       &   38 &   347\\\\\n",
       "\t D. leucas        & 1012 &  7443\\\\\n",
       "\t E. australis     &  549 &   866\\\\\n",
       "\t E. robustus      &  185 &  1123\\\\\n",
       "\t F. attenuata     &   24 &    76\\\\\n",
       "\t G. macrorhynchus &  214 &   367\\\\\n",
       "\t G. melas         &  375 &   616\\\\\n",
       "\t L. acutus        &  175 &   229\\\\\n",
       "\t L. hosei         &   13 &    14\\\\\n",
       "\t L. obscurus      & 2731 &  3139\\\\\n",
       "\t M. novaeangliae  & 2679 &  7392\\\\\n",
       "\t O. orca          &  472 &  2455\\\\\n",
       "\t P. crassidens    &  196 &  3326\\\\\n",
       "\t P. electra       & 1323 &  1689\\\\\n",
       "\t S. attenuata     &   44 &   145\\\\\n",
       "\t S. bredanensis   &   46 &    60\\\\\n",
       "\t S. frontalis     &  280 &   490\\\\\n",
       "\t S. longirostris  &  891 &  1700\\\\\n",
       "\t T. truncatus     &  904 & 10781\\\\\n",
       "\t Z. cavirostris   &  183 &   341\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A tibble: 26 × 3\n",
       "\n",
       "| specy &lt;chr&gt; | individuals &lt;int&gt; | pictures &lt;int&gt; |\n",
       "|---|---|---|\n",
       "| B. acutorostrata |  128 |  1608 |\n",
       "| B. borealis      |  197 |   428 |\n",
       "| B. brydei        |   44 |   154 |\n",
       "| B. musculus      | 2348 |  4830 |\n",
       "| B. physalus      |  466 |  1324 |\n",
       "| C. commersonii   |   70 |    90 |\n",
       "| D. delphis       |   38 |   347 |\n",
       "| D. leucas        | 1012 |  7443 |\n",
       "| E. australis     |  549 |   866 |\n",
       "| E. robustus      |  185 |  1123 |\n",
       "| F. attenuata     |   24 |    76 |\n",
       "| G. macrorhynchus |  214 |   367 |\n",
       "| G. melas         |  375 |   616 |\n",
       "| L. acutus        |  175 |   229 |\n",
       "| L. hosei         |   13 |    14 |\n",
       "| L. obscurus      | 2731 |  3139 |\n",
       "| M. novaeangliae  | 2679 |  7392 |\n",
       "| O. orca          |  472 |  2455 |\n",
       "| P. crassidens    |  196 |  3326 |\n",
       "| P. electra       | 1323 |  1689 |\n",
       "| S. attenuata     |   44 |   145 |\n",
       "| S. bredanensis   |   46 |    60 |\n",
       "| S. frontalis     |  280 |   490 |\n",
       "| S. longirostris  |  891 |  1700 |\n",
       "| T. truncatus     |  904 | 10781 |\n",
       "| Z. cavirostris   |  183 |   341 |\n",
       "\n"
      ],
      "text/plain": [
       "   specy            individuals pictures\n",
       "1  B. acutorostrata  128         1608   \n",
       "2  B. borealis       197          428   \n",
       "3  B. brydei          44          154   \n",
       "4  B. musculus      2348         4830   \n",
       "5  B. physalus       466         1324   \n",
       "6  C. commersonii     70           90   \n",
       "7  D. delphis         38          347   \n",
       "8  D. leucas        1012         7443   \n",
       "9  E. australis      549          866   \n",
       "10 E. robustus       185         1123   \n",
       "11 F. attenuata       24           76   \n",
       "12 G. macrorhynchus  214          367   \n",
       "13 G. melas          375          616   \n",
       "14 L. acutus         175          229   \n",
       "15 L. hosei           13           14   \n",
       "16 L. obscurus      2731         3139   \n",
       "17 M. novaeangliae  2679         7392   \n",
       "18 O. orca           472         2455   \n",
       "19 P. crassidens     196         3326   \n",
       "20 P. electra       1323         1689   \n",
       "21 S. attenuata       44          145   \n",
       "22 S. bredanensis     46           60   \n",
       "23 S. frontalis      280          490   \n",
       "24 S. longirostris   891         1700   \n",
       "25 T. truncatus      904        10781   \n",
       "26 Z. cavirostris    183          341   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "data %>%\n",
    "    group_by(specy) %>%\n",
    "    summarise(\n",
    "        individuals = n_distinct(individual),\n",
    "        pictures = n(),\n",
    "    )"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "20402f70",
   "metadata": {
    "papermill": {
     "duration": 0.047971,
     "end_time": "2022-03-17T12:39:06.678172",
     "exception": false,
     "start_time": "2022-03-17T12:39:06.630201",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Indexing all observations\n",
    "\n",
    "In order to get a representative sampling, we index all observations by specy and individual. This will be used afterwards to select files to label."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "2d02f487",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-17T12:39:06.772454Z",
     "iopub.status.busy": "2022-03-17T12:39:06.770922Z",
     "iopub.status.idle": "2022-03-17T12:39:07.563339Z",
     "shell.execute_reply": "2022-03-17T12:39:07.562666Z"
    },
    "papermill": {
     "duration": 0.842351,
     "end_time": "2022-03-17T12:39:07.563492",
     "exception": false,
     "start_time": "2022-03-17T12:39:06.721141",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A grouped_df: 51033 × 7</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>family</th><th scope=col>genus</th><th scope=col>specy</th><th scope=col>individual</th><th scope=col>picture</th><th scope=col>ids</th><th scope=col>idi</th></tr>\n",
       "\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>Balaenidae     </td><td>Eubalaena      </td><td>E. australis    </td><td>f5eab86405b4</td><td>002618d6f63ebc.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera   </td><td>B. acutorostrata</td><td>19fbb960f07d</td><td>001001f099519f.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera   </td><td>B. borealis     </td><td>fb492f141125</td><td>00647f8ff9f243.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera   </td><td>B. brydei       </td><td>a5fa185061f0</td><td>00eb689c10db84.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera   </td><td>B. musculus     </td><td>4790ec346170</td><td>0018064338b499.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera   </td><td>B. physalus     </td><td>180c0ab04dcd</td><td>00103cbe9d25ce.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Eschrichtius   </td><td>E. robustus     </td><td>a8c9dfb8ac6f</td><td>0020004d64ae20.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Megaptera      </td><td>M. novaeangliae </td><td>1a71fbb72250</td><td>000562241d384d.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Cephalorhynchus</td><td>C. commersonii  </td><td>21833976de5f</td><td>00f9b3f53e440e.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Delphinus      </td><td>D. delphis      </td><td>e943980b7a98</td><td>002e00960cec44.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Feresa         </td><td>F. attenuata    </td><td>896640802caf</td><td>08f78dfe5306df.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Globicephala   </td><td>G. macrorhynchus</td><td>4fb5ef2a9b98</td><td>01614d81068ff6.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Globicephala   </td><td>G. melas        </td><td>fefd0899a5dc</td><td>0036b5c11b39f3.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Lagenodelphis  </td><td>L. hosei        </td><td>c850b153e202</td><td>206dcfbb2ded4f.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Lagenorhynchus </td><td>L. acutus       </td><td>e6729cf51870</td><td>0111e5b7996776.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Lagenorhynchus </td><td>L. obscurus     </td><td>456bb79da64c</td><td>003e374b59c0e1.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Orcinus        </td><td>O. orca         </td><td>1816cc1ae38b</td><td>0030835e895969.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Peponocephala  </td><td>P. electra      </td><td>cadddb1636b9</td><td>00021adfb725ed.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Pseudorca      </td><td>P. crassidens   </td><td>60008f293a2b</td><td>0007c33415ce37.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Stenella       </td><td>S. attenuata    </td><td>c47159d4f91b</td><td>02324e8b007b2e.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Stenella       </td><td>S. frontalis    </td><td>bc05e97f4fea</td><td>009642068626f9.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Stenella       </td><td>S. longirostris </td><td>453039468cbf</td><td>007097146016e6.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>Steno          </td><td>S. bredanensis  </td><td>843568d8b320</td><td>021541b01f2d99.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Delphinidae    </td><td>tursiops       </td><td>T. truncatus    </td><td>4b00fe572063</td><td>0007d9bca26a99.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Monodontidae   </td><td>Delphinapterus </td><td>D. leucas       </td><td>afb9b3978217</td><td>000be9acf46619.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Ziphiidae      </td><td>Ziphius        </td><td>Z. cavirostris  </td><td>9bb396533ccc</td><td>00870a2b4f5f60.jpg</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenidae     </td><td>Eubalaena      </td><td>E. australis    </td><td>98336401fb38</td><td>0104ac335f66f9.jpg</td><td>2</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera   </td><td>B. acutorostrata</td><td>780fefdb6198</td><td>001f1a1f22da96.jpg</td><td>2</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera   </td><td>B. borealis     </td><td>2f5a62b26ef2</td><td>006cc681396f71.jpg</td><td>2</td><td>1</td></tr>\n",
       "\t<tr><td>Balaenopteridae</td><td>Balaenoptera   </td><td>B. brydei       </td><td>9a2649a6def4</td><td>02e20d67dea139.jpg</td><td>2</td><td>1</td></tr>\n",
       "\t<tr><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>90cfd1801b72</td><td>ff4b73053adefc.jpg</td><td>10752</td><td> 53</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>daa006a682c7</td><td>ff4ea2367fc186.jpg</td><td>10753</td><td> 56</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>0394f802c122</td><td>ff5bca18e8cebe.jpg</td><td>10754</td><td> 19</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>7217a2f5b150</td><td>ff5cad7a5b15a0.jpg</td><td>10755</td><td>  2</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>211957ad49f1</td><td>ff5ea433334cae.jpg</td><td>10756</td><td> 42</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>1191a41ee0f4</td><td>ff6584980ae6d3.jpg</td><td>10757</td><td>121</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>9e89f8e28807</td><td>ff7cb1614e59c6.jpg</td><td>10758</td><td>141</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>ca5790ec97b4</td><td>ff846ec4c6314e.jpg</td><td>10759</td><td>  8</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>65115a5e60a4</td><td>ff866d112806e9.jpg</td><td>10760</td><td> 56</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>951dfcc13838</td><td>ff910f44409770.jpg</td><td>10761</td><td> 24</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>f195c38bcf17</td><td>ff930dd529f89c.jpg</td><td>10762</td><td>146</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>6398f8680938</td><td>ff953e5adef3fa.jpg</td><td>10763</td><td> 48</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>281504409737</td><td>ff9c01fe686a2c.jpg</td><td>10764</td><td>143</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>ed3416e01fe2</td><td>ff9c5040e152e1.jpg</td><td>10765</td><td> 11</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>cccdade6dad1</td><td>ff9df214e47542.jpg</td><td>10766</td><td> 17</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>5ca3ea3464fe</td><td>ff9e9841585dd4.jpg</td><td>10767</td><td> 17</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>811dcd23d4c8</td><td>ffac684ba0e92e.jpg</td><td>10768</td><td>  4</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>956562ff2888</td><td>ffb169348f1639.jpg</td><td>10769</td><td>130</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>2aa3e856e46e</td><td>ffba7c5276d0db.jpg</td><td>10770</td><td> 34</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>8ca0a04df7a1</td><td>ffbf1bcee87522.jpg</td><td>10771</td><td> 26</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>02da0e68dccd</td><td>ffc0b5fdda5e94.jpg</td><td>10772</td><td>122</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>600ab1de92d9</td><td>ffc5b9d994f677.jpg</td><td>10773</td><td>129</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>a6e325d8e924</td><td>ffc5eb215d5539.jpg</td><td>10774</td><td>154</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>ffbb4e585ff2</td><td>ffcc55db24e4d0.jpg</td><td>10775</td><td>145</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>a6e325d8e924</td><td>ffcee8fa2578c1.jpg</td><td>10776</td><td>155</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>3d8ae153f3d7</td><td>ffde8e59c047d3.jpg</td><td>10777</td><td> 15</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>a59972315f7d</td><td>ffe1a56bdd912c.jpg</td><td>10778</td><td> 70</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>956562ff2888</td><td>ffe24f955ff264.jpg</td><td>10779</td><td>131</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>424d49bef76e</td><td>ffecd4a6afc94a.jpg</td><td>10780</td><td> 11</td></tr>\n",
       "\t<tr><td>Delphinidae</td><td>tursiops</td><td>T. truncatus</td><td>4ddb2eeb5efb</td><td>fffdcd42312777.jpg</td><td>10781</td><td> 74</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A grouped\\_df: 51033 × 7\n",
       "\\begin{tabular}{lllllll}\n",
       " family & genus & specy & individual & picture & ids & idi\\\\\n",
       " <chr> & <chr> & <chr> & <chr> & <chr> & <int> & <int>\\\\\n",
       "\\hline\n",
       "\t Balaenidae      & Eubalaena       & E. australis     & f5eab86405b4 & 002618d6f63ebc.jpg & 1 & 1\\\\\n",
       "\t Balaenopteridae & Balaenoptera    & B. acutorostrata & 19fbb960f07d & 001001f099519f.jpg & 1 & 1\\\\\n",
       "\t Balaenopteridae & Balaenoptera    & B. borealis      & fb492f141125 & 00647f8ff9f243.jpg & 1 & 1\\\\\n",
       "\t Balaenopteridae & Balaenoptera    & B. brydei        & a5fa185061f0 & 00eb689c10db84.jpg & 1 & 1\\\\\n",
       "\t Balaenopteridae & Balaenoptera    & B. musculus      & 4790ec346170 & 0018064338b499.jpg & 1 & 1\\\\\n",
       "\t Balaenopteridae & Balaenoptera    & B. physalus      & 180c0ab04dcd & 00103cbe9d25ce.jpg & 1 & 1\\\\\n",
       "\t Balaenopteridae & Eschrichtius    & E. robustus      & a8c9dfb8ac6f & 0020004d64ae20.jpg & 1 & 1\\\\\n",
       "\t Balaenopteridae & Megaptera       & M. novaeangliae  & 1a71fbb72250 & 000562241d384d.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Cephalorhynchus & C. commersonii   & 21833976de5f & 00f9b3f53e440e.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Delphinus       & D. delphis       & e943980b7a98 & 002e00960cec44.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Feresa          & F. attenuata     & 896640802caf & 08f78dfe5306df.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Globicephala    & G. macrorhynchus & 4fb5ef2a9b98 & 01614d81068ff6.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Globicephala    & G. melas         & fefd0899a5dc & 0036b5c11b39f3.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Lagenodelphis   & L. hosei         & c850b153e202 & 206dcfbb2ded4f.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Lagenorhynchus  & L. acutus        & e6729cf51870 & 0111e5b7996776.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Lagenorhynchus  & L. obscurus      & 456bb79da64c & 003e374b59c0e1.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Orcinus         & O. orca          & 1816cc1ae38b & 0030835e895969.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Peponocephala   & P. electra       & cadddb1636b9 & 00021adfb725ed.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Pseudorca       & P. crassidens    & 60008f293a2b & 0007c33415ce37.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Stenella        & S. attenuata     & c47159d4f91b & 02324e8b007b2e.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Stenella        & S. frontalis     & bc05e97f4fea & 009642068626f9.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Stenella        & S. longirostris  & 453039468cbf & 007097146016e6.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & Steno           & S. bredanensis   & 843568d8b320 & 021541b01f2d99.jpg & 1 & 1\\\\\n",
       "\t Delphinidae     & tursiops        & T. truncatus     & 4b00fe572063 & 0007d9bca26a99.jpg & 1 & 1\\\\\n",
       "\t Monodontidae    & Delphinapterus  & D. leucas        & afb9b3978217 & 000be9acf46619.jpg & 1 & 1\\\\\n",
       "\t Ziphiidae       & Ziphius         & Z. cavirostris   & 9bb396533ccc & 00870a2b4f5f60.jpg & 1 & 1\\\\\n",
       "\t Balaenidae      & Eubalaena       & E. australis     & 98336401fb38 & 0104ac335f66f9.jpg & 2 & 1\\\\\n",
       "\t Balaenopteridae & Balaenoptera    & B. acutorostrata & 780fefdb6198 & 001f1a1f22da96.jpg & 2 & 1\\\\\n",
       "\t Balaenopteridae & Balaenoptera    & B. borealis      & 2f5a62b26ef2 & 006cc681396f71.jpg & 2 & 1\\\\\n",
       "\t Balaenopteridae & Balaenoptera    & B. brydei        & 9a2649a6def4 & 02e20d67dea139.jpg & 2 & 1\\\\\n",
       "\t ⋮ & ⋮ & ⋮ & ⋮ & ⋮ & ⋮ & ⋮\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 90cfd1801b72 & ff4b73053adefc.jpg & 10752 &  53\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & daa006a682c7 & ff4ea2367fc186.jpg & 10753 &  56\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 0394f802c122 & ff5bca18e8cebe.jpg & 10754 &  19\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 7217a2f5b150 & ff5cad7a5b15a0.jpg & 10755 &   2\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 211957ad49f1 & ff5ea433334cae.jpg & 10756 &  42\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 1191a41ee0f4 & ff6584980ae6d3.jpg & 10757 & 121\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 9e89f8e28807 & ff7cb1614e59c6.jpg & 10758 & 141\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & ca5790ec97b4 & ff846ec4c6314e.jpg & 10759 &   8\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 65115a5e60a4 & ff866d112806e9.jpg & 10760 &  56\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 951dfcc13838 & ff910f44409770.jpg & 10761 &  24\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & f195c38bcf17 & ff930dd529f89c.jpg & 10762 & 146\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 6398f8680938 & ff953e5adef3fa.jpg & 10763 &  48\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 281504409737 & ff9c01fe686a2c.jpg & 10764 & 143\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & ed3416e01fe2 & ff9c5040e152e1.jpg & 10765 &  11\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & cccdade6dad1 & ff9df214e47542.jpg & 10766 &  17\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 5ca3ea3464fe & ff9e9841585dd4.jpg & 10767 &  17\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 811dcd23d4c8 & ffac684ba0e92e.jpg & 10768 &   4\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 956562ff2888 & ffb169348f1639.jpg & 10769 & 130\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 2aa3e856e46e & ffba7c5276d0db.jpg & 10770 &  34\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 8ca0a04df7a1 & ffbf1bcee87522.jpg & 10771 &  26\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 02da0e68dccd & ffc0b5fdda5e94.jpg & 10772 & 122\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 600ab1de92d9 & ffc5b9d994f677.jpg & 10773 & 129\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & a6e325d8e924 & ffc5eb215d5539.jpg & 10774 & 154\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & ffbb4e585ff2 & ffcc55db24e4d0.jpg & 10775 & 145\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & a6e325d8e924 & ffcee8fa2578c1.jpg & 10776 & 155\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 3d8ae153f3d7 & ffde8e59c047d3.jpg & 10777 &  15\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & a59972315f7d & ffe1a56bdd912c.jpg & 10778 &  70\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 956562ff2888 & ffe24f955ff264.jpg & 10779 & 131\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 424d49bef76e & ffecd4a6afc94a.jpg & 10780 &  11\\\\\n",
       "\t Delphinidae & tursiops & T. truncatus & 4ddb2eeb5efb & fffdcd42312777.jpg & 10781 &  74\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A grouped_df: 51033 × 7\n",
       "\n",
       "| family &lt;chr&gt; | genus &lt;chr&gt; | specy &lt;chr&gt; | individual &lt;chr&gt; | picture &lt;chr&gt; | ids &lt;int&gt; | idi &lt;int&gt; |\n",
       "|---|---|---|---|---|---|---|\n",
       "| Balaenidae      | Eubalaena       | E. australis     | f5eab86405b4 | 002618d6f63ebc.jpg | 1 | 1 |\n",
       "| Balaenopteridae | Balaenoptera    | B. acutorostrata | 19fbb960f07d | 001001f099519f.jpg | 1 | 1 |\n",
       "| Balaenopteridae | Balaenoptera    | B. borealis      | fb492f141125 | 00647f8ff9f243.jpg | 1 | 1 |\n",
       "| Balaenopteridae | Balaenoptera    | B. brydei        | a5fa185061f0 | 00eb689c10db84.jpg | 1 | 1 |\n",
       "| Balaenopteridae | Balaenoptera    | B. musculus      | 4790ec346170 | 0018064338b499.jpg | 1 | 1 |\n",
       "| Balaenopteridae | Balaenoptera    | B. physalus      | 180c0ab04dcd | 00103cbe9d25ce.jpg | 1 | 1 |\n",
       "| Balaenopteridae | Eschrichtius    | E. robustus      | a8c9dfb8ac6f | 0020004d64ae20.jpg | 1 | 1 |\n",
       "| Balaenopteridae | Megaptera       | M. novaeangliae  | 1a71fbb72250 | 000562241d384d.jpg | 1 | 1 |\n",
       "| Delphinidae     | Cephalorhynchus | C. commersonii   | 21833976de5f | 00f9b3f53e440e.jpg | 1 | 1 |\n",
       "| Delphinidae     | Delphinus       | D. delphis       | e943980b7a98 | 002e00960cec44.jpg | 1 | 1 |\n",
       "| Delphinidae     | Feresa          | F. attenuata     | 896640802caf | 08f78dfe5306df.jpg | 1 | 1 |\n",
       "| Delphinidae     | Globicephala    | G. macrorhynchus | 4fb5ef2a9b98 | 01614d81068ff6.jpg | 1 | 1 |\n",
       "| Delphinidae     | Globicephala    | G. melas         | fefd0899a5dc | 0036b5c11b39f3.jpg | 1 | 1 |\n",
       "| Delphinidae     | Lagenodelphis   | L. hosei         | c850b153e202 | 206dcfbb2ded4f.jpg | 1 | 1 |\n",
       "| Delphinidae     | Lagenorhynchus  | L. acutus        | e6729cf51870 | 0111e5b7996776.jpg | 1 | 1 |\n",
       "| Delphinidae     | Lagenorhynchus  | L. obscurus      | 456bb79da64c | 003e374b59c0e1.jpg | 1 | 1 |\n",
       "| Delphinidae     | Orcinus         | O. orca          | 1816cc1ae38b | 0030835e895969.jpg | 1 | 1 |\n",
       "| Delphinidae     | Peponocephala   | P. electra       | cadddb1636b9 | 00021adfb725ed.jpg | 1 | 1 |\n",
       "| Delphinidae     | Pseudorca       | P. crassidens    | 60008f293a2b | 0007c33415ce37.jpg | 1 | 1 |\n",
       "| Delphinidae     | Stenella        | S. attenuata     | c47159d4f91b | 02324e8b007b2e.jpg | 1 | 1 |\n",
       "| Delphinidae     | Stenella        | S. frontalis     | bc05e97f4fea | 009642068626f9.jpg | 1 | 1 |\n",
       "| Delphinidae     | Stenella        | S. longirostris  | 453039468cbf | 007097146016e6.jpg | 1 | 1 |\n",
       "| Delphinidae     | Steno           | S. bredanensis   | 843568d8b320 | 021541b01f2d99.jpg | 1 | 1 |\n",
       "| Delphinidae     | tursiops        | T. truncatus     | 4b00fe572063 | 0007d9bca26a99.jpg | 1 | 1 |\n",
       "| Monodontidae    | Delphinapterus  | D. leucas        | afb9b3978217 | 000be9acf46619.jpg | 1 | 1 |\n",
       "| Ziphiidae       | Ziphius         | Z. cavirostris   | 9bb396533ccc | 00870a2b4f5f60.jpg | 1 | 1 |\n",
       "| Balaenidae      | Eubalaena       | E. australis     | 98336401fb38 | 0104ac335f66f9.jpg | 2 | 1 |\n",
       "| Balaenopteridae | Balaenoptera    | B. acutorostrata | 780fefdb6198 | 001f1a1f22da96.jpg | 2 | 1 |\n",
       "| Balaenopteridae | Balaenoptera    | B. borealis      | 2f5a62b26ef2 | 006cc681396f71.jpg | 2 | 1 |\n",
       "| Balaenopteridae | Balaenoptera    | B. brydei        | 9a2649a6def4 | 02e20d67dea139.jpg | 2 | 1 |\n",
       "| ⋮ | ⋮ | ⋮ | ⋮ | ⋮ | ⋮ | ⋮ |\n",
       "| Delphinidae | tursiops | T. truncatus | 90cfd1801b72 | ff4b73053adefc.jpg | 10752 |  53 |\n",
       "| Delphinidae | tursiops | T. truncatus | daa006a682c7 | ff4ea2367fc186.jpg | 10753 |  56 |\n",
       "| Delphinidae | tursiops | T. truncatus | 0394f802c122 | ff5bca18e8cebe.jpg | 10754 |  19 |\n",
       "| Delphinidae | tursiops | T. truncatus | 7217a2f5b150 | ff5cad7a5b15a0.jpg | 10755 |   2 |\n",
       "| Delphinidae | tursiops | T. truncatus | 211957ad49f1 | ff5ea433334cae.jpg | 10756 |  42 |\n",
       "| Delphinidae | tursiops | T. truncatus | 1191a41ee0f4 | ff6584980ae6d3.jpg | 10757 | 121 |\n",
       "| Delphinidae | tursiops | T. truncatus | 9e89f8e28807 | ff7cb1614e59c6.jpg | 10758 | 141 |\n",
       "| Delphinidae | tursiops | T. truncatus | ca5790ec97b4 | ff846ec4c6314e.jpg | 10759 |   8 |\n",
       "| Delphinidae | tursiops | T. truncatus | 65115a5e60a4 | ff866d112806e9.jpg | 10760 |  56 |\n",
       "| Delphinidae | tursiops | T. truncatus | 951dfcc13838 | ff910f44409770.jpg | 10761 |  24 |\n",
       "| Delphinidae | tursiops | T. truncatus | f195c38bcf17 | ff930dd529f89c.jpg | 10762 | 146 |\n",
       "| Delphinidae | tursiops | T. truncatus | 6398f8680938 | ff953e5adef3fa.jpg | 10763 |  48 |\n",
       "| Delphinidae | tursiops | T. truncatus | 281504409737 | ff9c01fe686a2c.jpg | 10764 | 143 |\n",
       "| Delphinidae | tursiops | T. truncatus | ed3416e01fe2 | ff9c5040e152e1.jpg | 10765 |  11 |\n",
       "| Delphinidae | tursiops | T. truncatus | cccdade6dad1 | ff9df214e47542.jpg | 10766 |  17 |\n",
       "| Delphinidae | tursiops | T. truncatus | 5ca3ea3464fe | ff9e9841585dd4.jpg | 10767 |  17 |\n",
       "| Delphinidae | tursiops | T. truncatus | 811dcd23d4c8 | ffac684ba0e92e.jpg | 10768 |   4 |\n",
       "| Delphinidae | tursiops | T. truncatus | 956562ff2888 | ffb169348f1639.jpg | 10769 | 130 |\n",
       "| Delphinidae | tursiops | T. truncatus | 2aa3e856e46e | ffba7c5276d0db.jpg | 10770 |  34 |\n",
       "| Delphinidae | tursiops | T. truncatus | 8ca0a04df7a1 | ffbf1bcee87522.jpg | 10771 |  26 |\n",
       "| Delphinidae | tursiops | T. truncatus | 02da0e68dccd | ffc0b5fdda5e94.jpg | 10772 | 122 |\n",
       "| Delphinidae | tursiops | T. truncatus | 600ab1de92d9 | ffc5b9d994f677.jpg | 10773 | 129 |\n",
       "| Delphinidae | tursiops | T. truncatus | a6e325d8e924 | ffc5eb215d5539.jpg | 10774 | 154 |\n",
       "| Delphinidae | tursiops | T. truncatus | ffbb4e585ff2 | ffcc55db24e4d0.jpg | 10775 | 145 |\n",
       "| Delphinidae | tursiops | T. truncatus | a6e325d8e924 | ffcee8fa2578c1.jpg | 10776 | 155 |\n",
       "| Delphinidae | tursiops | T. truncatus | 3d8ae153f3d7 | ffde8e59c047d3.jpg | 10777 |  15 |\n",
       "| Delphinidae | tursiops | T. truncatus | a59972315f7d | ffe1a56bdd912c.jpg | 10778 |  70 |\n",
       "| Delphinidae | tursiops | T. truncatus | 956562ff2888 | ffe24f955ff264.jpg | 10779 | 131 |\n",
       "| Delphinidae | tursiops | T. truncatus | 424d49bef76e | ffecd4a6afc94a.jpg | 10780 |  11 |\n",
       "| Delphinidae | tursiops | T. truncatus | 4ddb2eeb5efb | fffdcd42312777.jpg | 10781 |  74 |\n",
       "\n"
      ],
      "text/plain": [
       "      family          genus           specy            individual  \n",
       "1     Balaenidae      Eubalaena       E. australis     f5eab86405b4\n",
       "2     Balaenopteridae Balaenoptera    B. acutorostrata 19fbb960f07d\n",
       "3     Balaenopteridae Balaenoptera    B. borealis      fb492f141125\n",
       "4     Balaenopteridae Balaenoptera    B. brydei        a5fa185061f0\n",
       "5     Balaenopteridae Balaenoptera    B. musculus      4790ec346170\n",
       "6     Balaenopteridae Balaenoptera    B. physalus      180c0ab04dcd\n",
       "7     Balaenopteridae Eschrichtius    E. robustus      a8c9dfb8ac6f\n",
       "8     Balaenopteridae Megaptera       M. novaeangliae  1a71fbb72250\n",
       "9     Delphinidae     Cephalorhynchus C. commersonii   21833976de5f\n",
       "10    Delphinidae     Delphinus       D. delphis       e943980b7a98\n",
       "11    Delphinidae     Feresa          F. attenuata     896640802caf\n",
       "12    Delphinidae     Globicephala    G. macrorhynchus 4fb5ef2a9b98\n",
       "13    Delphinidae     Globicephala    G. melas         fefd0899a5dc\n",
       "14    Delphinidae     Lagenodelphis   L. hosei         c850b153e202\n",
       "15    Delphinidae     Lagenorhynchus  L. acutus        e6729cf51870\n",
       "16    Delphinidae     Lagenorhynchus  L. obscurus      456bb79da64c\n",
       "17    Delphinidae     Orcinus         O. orca          1816cc1ae38b\n",
       "18    Delphinidae     Peponocephala   P. electra       cadddb1636b9\n",
       "19    Delphinidae     Pseudorca       P. crassidens    60008f293a2b\n",
       "20    Delphinidae     Stenella        S. attenuata     c47159d4f91b\n",
       "21    Delphinidae     Stenella        S. frontalis     bc05e97f4fea\n",
       "22    Delphinidae     Stenella        S. longirostris  453039468cbf\n",
       "23    Delphinidae     Steno           S. bredanensis   843568d8b320\n",
       "24    Delphinidae     tursiops        T. truncatus     4b00fe572063\n",
       "25    Monodontidae    Delphinapterus  D. leucas        afb9b3978217\n",
       "26    Ziphiidae       Ziphius         Z. cavirostris   9bb396533ccc\n",
       "27    Balaenidae      Eubalaena       E. australis     98336401fb38\n",
       "28    Balaenopteridae Balaenoptera    B. acutorostrata 780fefdb6198\n",
       "29    Balaenopteridae Balaenoptera    B. borealis      2f5a62b26ef2\n",
       "30    Balaenopteridae Balaenoptera    B. brydei        9a2649a6def4\n",
       "⋮     ⋮               ⋮               ⋮                ⋮           \n",
       "51004 Delphinidae     tursiops        T. truncatus     90cfd1801b72\n",
       "51005 Delphinidae     tursiops        T. truncatus     daa006a682c7\n",
       "51006 Delphinidae     tursiops        T. truncatus     0394f802c122\n",
       "51007 Delphinidae     tursiops        T. truncatus     7217a2f5b150\n",
       "51008 Delphinidae     tursiops        T. truncatus     211957ad49f1\n",
       "51009 Delphinidae     tursiops        T. truncatus     1191a41ee0f4\n",
       "51010 Delphinidae     tursiops        T. truncatus     9e89f8e28807\n",
       "51011 Delphinidae     tursiops        T. truncatus     ca5790ec97b4\n",
       "51012 Delphinidae     tursiops        T. truncatus     65115a5e60a4\n",
       "51013 Delphinidae     tursiops        T. truncatus     951dfcc13838\n",
       "51014 Delphinidae     tursiops        T. truncatus     f195c38bcf17\n",
       "51015 Delphinidae     tursiops        T. truncatus     6398f8680938\n",
       "51016 Delphinidae     tursiops        T. truncatus     281504409737\n",
       "51017 Delphinidae     tursiops        T. truncatus     ed3416e01fe2\n",
       "51018 Delphinidae     tursiops        T. truncatus     cccdade6dad1\n",
       "51019 Delphinidae     tursiops        T. truncatus     5ca3ea3464fe\n",
       "51020 Delphinidae     tursiops        T. truncatus     811dcd23d4c8\n",
       "51021 Delphinidae     tursiops        T. truncatus     956562ff2888\n",
       "51022 Delphinidae     tursiops        T. truncatus     2aa3e856e46e\n",
       "51023 Delphinidae     tursiops        T. truncatus     8ca0a04df7a1\n",
       "51024 Delphinidae     tursiops        T. truncatus     02da0e68dccd\n",
       "51025 Delphinidae     tursiops        T. truncatus     600ab1de92d9\n",
       "51026 Delphinidae     tursiops        T. truncatus     a6e325d8e924\n",
       "51027 Delphinidae     tursiops        T. truncatus     ffbb4e585ff2\n",
       "51028 Delphinidae     tursiops        T. truncatus     a6e325d8e924\n",
       "51029 Delphinidae     tursiops        T. truncatus     3d8ae153f3d7\n",
       "51030 Delphinidae     tursiops        T. truncatus     a59972315f7d\n",
       "51031 Delphinidae     tursiops        T. truncatus     956562ff2888\n",
       "51032 Delphinidae     tursiops        T. truncatus     424d49bef76e\n",
       "51033 Delphinidae     tursiops        T. truncatus     4ddb2eeb5efb\n",
       "      picture            ids   idi\n",
       "1     002618d6f63ebc.jpg 1     1  \n",
       "2     001001f099519f.jpg 1     1  \n",
       "3     00647f8ff9f243.jpg 1     1  \n",
       "4     00eb689c10db84.jpg 1     1  \n",
       "5     0018064338b499.jpg 1     1  \n",
       "6     00103cbe9d25ce.jpg 1     1  \n",
       "7     0020004d64ae20.jpg 1     1  \n",
       "8     000562241d384d.jpg 1     1  \n",
       "9     00f9b3f53e440e.jpg 1     1  \n",
       "10    002e00960cec44.jpg 1     1  \n",
       "11    08f78dfe5306df.jpg 1     1  \n",
       "12    01614d81068ff6.jpg 1     1  \n",
       "13    0036b5c11b39f3.jpg 1     1  \n",
       "14    206dcfbb2ded4f.jpg 1     1  \n",
       "15    0111e5b7996776.jpg 1     1  \n",
       "16    003e374b59c0e1.jpg 1     1  \n",
       "17    0030835e895969.jpg 1     1  \n",
       "18    00021adfb725ed.jpg 1     1  \n",
       "19    0007c33415ce37.jpg 1     1  \n",
       "20    02324e8b007b2e.jpg 1     1  \n",
       "21    009642068626f9.jpg 1     1  \n",
       "22    007097146016e6.jpg 1     1  \n",
       "23    021541b01f2d99.jpg 1     1  \n",
       "24    0007d9bca26a99.jpg 1     1  \n",
       "25    000be9acf46619.jpg 1     1  \n",
       "26    00870a2b4f5f60.jpg 1     1  \n",
       "27    0104ac335f66f9.jpg 2     1  \n",
       "28    001f1a1f22da96.jpg 2     1  \n",
       "29    006cc681396f71.jpg 2     1  \n",
       "30    02e20d67dea139.jpg 2     1  \n",
       "⋮     ⋮                  ⋮     ⋮  \n",
       "51004 ff4b73053adefc.jpg 10752  53\n",
       "51005 ff4ea2367fc186.jpg 10753  56\n",
       "51006 ff5bca18e8cebe.jpg 10754  19\n",
       "51007 ff5cad7a5b15a0.jpg 10755   2\n",
       "51008 ff5ea433334cae.jpg 10756  42\n",
       "51009 ff6584980ae6d3.jpg 10757 121\n",
       "51010 ff7cb1614e59c6.jpg 10758 141\n",
       "51011 ff846ec4c6314e.jpg 10759   8\n",
       "51012 ff866d112806e9.jpg 10760  56\n",
       "51013 ff910f44409770.jpg 10761  24\n",
       "51014 ff930dd529f89c.jpg 10762 146\n",
       "51015 ff953e5adef3fa.jpg 10763  48\n",
       "51016 ff9c01fe686a2c.jpg 10764 143\n",
       "51017 ff9c5040e152e1.jpg 10765  11\n",
       "51018 ff9df214e47542.jpg 10766  17\n",
       "51019 ff9e9841585dd4.jpg 10767  17\n",
       "51020 ffac684ba0e92e.jpg 10768   4\n",
       "51021 ffb169348f1639.jpg 10769 130\n",
       "51022 ffba7c5276d0db.jpg 10770  34\n",
       "51023 ffbf1bcee87522.jpg 10771  26\n",
       "51024 ffc0b5fdda5e94.jpg 10772 122\n",
       "51025 ffc5b9d994f677.jpg 10773 129\n",
       "51026 ffc5eb215d5539.jpg 10774 154\n",
       "51027 ffcc55db24e4d0.jpg 10775 145\n",
       "51028 ffcee8fa2578c1.jpg 10776 155\n",
       "51029 ffde8e59c047d3.jpg 10777  15\n",
       "51030 ffe1a56bdd912c.jpg 10778  70\n",
       "51031 ffe24f955ff264.jpg 10779 131\n",
       "51032 ffecd4a6afc94a.jpg 10780  11\n",
       "51033 fffdcd42312777.jpg 10781  74"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "datarank <- data %>% \n",
    "    group_by(family, genus, specy) %>%\n",
    "    mutate(ids = row_number()) %>%\n",
    "    group_by(family, genus, specy, individual) %>%\n",
    "    mutate(idi = row_number()) %>%\n",
    "    arrange(ids, family, genus, specy, idi)\n",
    "datarank"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "8e78121e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-17T12:39:07.665723Z",
     "iopub.status.busy": "2022-03-17T12:39:07.664937Z",
     "iopub.status.idle": "2022-03-17T12:39:07.938048Z",
     "shell.execute_reply": "2022-03-17T12:39:07.935940Z"
    },
    "papermill": {
     "duration": 0.324757,
     "end_time": "2022-03-17T12:39:07.938210",
     "exception": false,
     "start_time": "2022-03-17T12:39:07.613453",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "write_csv(datarank, \"datarank.csv\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "4.0.5"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 8.242291,
   "end_time": "2022-03-17T12:39:08.078654",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2022-03-17T12:38:59.836363",
   "version": "2.3.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
